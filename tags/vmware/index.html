<!DOCTYPE html>

<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>Dave&#39;s Site</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<!--[if lt IE 9]>
	<script src="http://www.dpetzel.info//js/html5.js"></script>
	<![endif]-->

    <link href="http://www.dpetzel.info//index.xml" rel="alternate" type="application/rss+xml" title="Dave&#39;s Site" />

    <link rel='stylesheet' id='twentyfourteen-lato-css'  href='//fonts.googleapis.com/css?family=Lato%3A300%2C400%2C700%2C900%2C300italic%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />

    <link rel='stylesheet' id='genericons-css' href='http://www.dpetzel.info//genericons/genericons.css' type='text/css' media='all' />
	<link rel='stylesheet' id='twentyfourteen-style-css' href='http://www.dpetzel.info//css/style.css' type='text/css' media='all' />
	
	<script type='text/javascript' src='http://www.dpetzel.info//js/jquery/jquery.js'></script>
	<script type='text/javascript' src='http://www.dpetzel.info//js/jquery/jquery-migrate.min.js'></script>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>

	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/default.min.css">
	<style type='text/css'>
	pre, code {
	    white-space: pre;
	    overflow-x: scroll;
			width: auto;
	}
	.hljs {
	    display: inline-block;
	    padding: 0.5em;
	    padding-right: 5%;
	    background: #002b36;
	    color: #839496;
	}
	</style>
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/highlight.min.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
</head>

<body class="home blog masthead-fixed list-view full-width grid">
<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
		<div class="header-main">
			<h1 class="site-title"><a href="http://www.dpetzel.info//index.html" rel="home">Dave&#39;s Site</a></h1>

			<div class="search-toggle">
				<a href="#search-container" class="screen-reader-text">Search</a>
			</div>

			<nav id="primary-navigation" class="site-navigation primary-navigation" role="navigation">
				<button class="menu-toggle">Primary Menu</button>
				<a class="screen-reader-text skip-link" href="#content">Skip to content</a>
				<div class="nav-menu">
					<ul>
						
						<li class="page_item">
							<a href="/about/">About Me</a>
						</li>
						
						<li class="page_item">
							<a href="/resume/">Resume</a>
						</li>
						
					</ul>
				</div>
			</nav>
		</div>

		<div id="search-container" class="search-box-wrapper hide">
			<div class="search-box">
                <script type="text/javascript">
    function site_search(obj) {
    	var host = window.location.host;
        obj.q.value = "site:" + host + " " + obj.ss_q.value;
    }
</script>

<aside id="search-3" class="widget widget_search">
	<form role="search" class="search-form" action="//www.google.com/search" method="get" onSubmit="site_search(this)">

	<input name="q" type="hidden" />
	    <label>
	        <span class="screen-reader-text">Search for:</span>
	        <input name="ss_q" type="text" placeholder="Search ..." class="search-field" />
	    </label>
	    <input type="submit" value="Search" class="search-submit" />
	</form>
</aside>
			</div>
		</div>
	</header>

	<div id="main" class="site-main">


<div id="main-content" class="main-content">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">
			<div id="googleads" class="site-content">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  
  <ins class="adsbygoogle"
       style="display:inline-block;width:728px;height:90px"
       data-ad-client="ca-pub-3085354840505663"
       data-ad-slot="2904100968"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


			<header class="archive-header">
				<h1 class="archive-title">Vmware Archive</h1>
			</header>

			
				<article class="post type-post status-publish format-standard hentry">

	
	<header class="entry-header">

	


		<div class="entry-meta">
			<span class="cat-links">
                
                <a href="http://www.dpetzel.info//categories/system-administration/index.html" rel="category">System Administration</a>
                
			</span>
		</div>

		<h1 class="entry-title">Building a Dell T420 with ESXi 5</h1>

		
		<div class="entry-meta">
			<span class="entry-date">
				<a href="http://www.dpetzel.info/post/building-a-dell-t420-with-esxi-5//index.html" rel="bookmark">
					<time class="entry-date" datetime="2013-11-24 00:00:00 &#43;0000 UTC">
						November 24 2013
					</time>
				</a>
			</span>
		</div>
		

	</header>

	<div class="entry-content">
		

<p>I recently got the opportunity to play with a new Dell T420, and I decided I
would run ESXi 5 on it.</p>

<h2 id="background">Background</h2>

<p>My day job does not really allow me much hands on access to hardware any more
so its been a while since I&rsquo;ve gotten to build a new server, but I recently got
the chance to work on this as a side project. The server came
pre-installed with Windows 2012 Standard. I have a need to run a couple of VM&rsquo;s and I
decided I wanted to run ESXi on the host, and run the 2013 standard box as
a VM. For anyone that is curious, I didn&rsquo;t pick ESXi because its &laquo;better&raquo; than
Hyper-V (I have no clue how they stack up anymore). I simply chose it because
its been a couple of years since I&rsquo;ve built an ESX host and I wanted to see
how things have evolved.</p>

<p>The first thing I did was use the VMWare converter utility to P2V the existing
installation out to a VMWare workstation format. I didn&rsquo;t <em>really</em> need to do
this since the OS was not customized yet, and I could reinstall, but this
was a chance to play with the converter, and see if if I could PBV the existing
installation and have it running on the newly rebuilt box. It worked well,
and maybe I&rsquo;ll write about that experience some day, but for now its all
about getting the box built.</p>

<h2 id="installing-open-manage-server-administrator">Installing Open Manage Server Administrator</h2>

<p>So step one was to grab the installation bits from
<a href="http://www.dell.com/support/drivers/us/en/19/DriverDetails/Product/poweredge-r710?driverId=WHYNF&amp;fileId=3006491785">Open Manage Download</a>.
I went with version 7.3.0.2 as it was the most recent available. It downloaded
the file to my workstation, as opposed to directly on the ESX host.</p>

<p>Next I started following the ESXi specific instructions in the
<a href="ftp://ftp.dell.com/Manuals/all-products/esuprt_software/esuprt_ent_sys_mgmt/esuprt_ent_sys_mgmt_opnmng_sw/dell-opnmang-sw-v7.3_User%27s%20Guide2_en-us.pdf">Open Manage User Guide</a>.
While I can appreciate the time it takes to work up instructions that cover such
a wide array of platforms, I found these instructions a bit lacking. They had
several typos (missing spaces in command line commands) as well as were unclear
on a couple things, so I&rsquo;ll spend a little more time to add some details here.</p>

<p>I chose to go with the &laquo;Using The vSphere CLI&raquo; portion of the instructions, as
it seemed to be the most straight forward for folks without existing ESX
infrastructures in place. So with that, I had to download and install the
<a href="http://www.vmware.com/support/developer/vcli/">vSphere CLI</a>. This was pretty quick and painless. I didn&rsquo;t poke to much
at it, but it feels like its nothing more than a set of Perl scripts and it
adds a shortcut to a CMD session which I presume just tweaks the shell with
some environment variables</p>

<p>Now I copied the file over the suggested directory per the docs (I had to enable
 and start SSH access using the vSphere Client before this would work).</p>

<pre><code class="language-batch">   pscp OM-SrvAdmin-Dell-Web-7.3.0-588_A00.VIB-ESX51i.zip root@192.168.1.1:/var/log/vmware/
   Using keyboard-interactive authentication.
   Password:
   OM-SrvAdmin-Dell-Web-7.3. | 6490 kB | 1622.6 kB/s | ETA: 00:00:00 | 100%
</code></pre>

<p>So I&rsquo;m not sure how the docs assume you to unzip this, but I did it over an SSH
session, and the part that I messed up on first was that I unzipped the file
directly in <code>/var/log/vmware/</code>, when in reality all you have to do is run the
install command against the ZIP directly. There is no need to actually unzip it.</p>

<p>I later learned about the <a href="http://www.vmware.com/support/developer/vima/">vSphere Management Assistant</a>,
which I think is geared toward keeping SSH out of the mix. for now I ran the
command using the CLI</p>

<pre><code class="language-console">   esxcli --server 192.168.1.1 software vib install -d /var/log/vmware/OM-SrvAdmin-Dell-Web-7.3.0-588_A00.VIB-ESX51i.zip

   Installation Result
      Message: The update completed successfully, but the system needs to be rebooted for the changes to be effective.
      Reboot Required: true
      VIBs Installed: Dell_bootbank_OpenManage_7.3.0.2-0000
      VIBs Removed:
      VIBs Skipped:
</code></pre>

<p>And then comes a reboot. Following the reboot I expected I would be able
to hit the OMSA HTTPS interface at <a href="https://192.168.1.1:1311">https://192.168.1.1:1311</a>, however that didn&rsquo;t
work, and it turns out is more more involved, and covered in the &laquo;Accessing Server Administrator on VMware ESXi&raquo;
section. Essentially it suggests that you have to a <strong>completely separate</strong>,
server running the web server. In my case, this is the only box on the network
so this seems like a crappy solution, but I suppose the logic is possibly to
keep the number of system daemons to an absolute minimum. In any event, I was
a bit disappointed to lose the web UI I&rsquo;ve grown to know.</p>

<h2 id="vsphere-management-assistant">vSphere Management Assistant</h2>

<p>At this point, I was a bit annoyed that I needed another system.
While trolling for ways to potentially hack the Web server in directly, I came
across a YouTube video on the subject at <a href="http://www.youtube.com/watch?v=hywERi8bc1c">http://www.youtube.com/watch?v=hywERi8bc1c</a>.
While watching this at about 1:31 they jump to a screen I was not familiar with,
and after a little digging I discovered the
<a href="http://www.vmware.com/support/developer/vima/">vSphere Management Assistant</a>,
so I proceeded to download and <em>install</em> the virtual appliance as it seems it
will come in handy in the future as well.</p>

<p>So I downloaded the appliance, unzipped the file and and then followed the
instructions at <a href="http://pubs.vmware.com/vsphere-55/index.jsp#com.vmware.vma.doc/vima_get_start.4.5.html">http://pubs.vmware.com/vsphere-55/index.jsp#com.vmware.vma.doc/vima_get_start.4.5.html</a>.
This all went really smooth.</p>

<h2 id="installing-dell-omsa-into-the-vsphere-management-assistant">Installing Dell OMSA into the vSphere Management Assistant</h2>

<p>So I figured what the heck, at this point I have a VM already, lets install
the OMSA web interface here since I couldn&rsquo;t do it earlier. So I downloaded
the file from the dell website (they make it harder than is should be to get a
direct download link that I could wget from inside the VM so instead I
downloaded it on my workstation and uploaded it.</p>

<pre><code class="language-batch">pscp OM-SrvAdmin-Dell-Web-LX-7.3.0-350_A00.SLES11.x86_64.tar.gz vi-admin@192.168.1.2:/tmp
</code></pre>

<p>Then via an SSH into the VMA appliance:</p>

<pre><code class="language-console">   cd /tmp
   tar -zxvf OM-SrvAdmin-Dell-Web-LX-7.3.0-350_A00.SLES11.x86_64.tar.gz
   sudo ./setup.sh
</code></pre>

<p>Accept the license agreement, and hit option 1 to install the Server Administrator Web Server Interface.
Followed by pressing &laquo;i&raquo;</p>

<p>And about 2 minutes later, we have our good old friend, the Open Manager web
interface available at https//vmaappliance_ip:1311, and I was able to use
it to connect to my ESXi host. A bit of a round about where to get there, but
something is better than nothing..</p>

	</div>

	<footer class="entry-meta">
		<span class="tag-links">
			
                <a href="http://www.dpetzel.info//tags/dell/index.html" rel="tag">Dell</a>
            
                <a href="http://www.dpetzel.info//tags/vmware/index.html" rel="tag">VMware</a>
            
                <a href="http://www.dpetzel.info//tags/esx/index.html" rel="tag">ESX</a>
            
                <a href="http://www.dpetzel.info//tags/omsa/index.html" rel="tag">OMSA</a>
            
                <a href="http://www.dpetzel.info//tags/open-manage/index.html" rel="tag">Open Manage</a>
            
		</span>
	</footer>
</article> 

			

		</div>
	</div>
	<div id="secondary">

	

	<div id="primary-sidebar" class="primary-sidebar widget-area" role="complementary">

		<script type="text/javascript">
    function site_search(obj) {
    	var host = window.location.host;
        obj.q.value = "site:" + host + " " + obj.ss_q.value;
    }
</script>

<aside id="search-3" class="widget widget_search">
	<form role="search" class="search-form" action="//www.google.com/search" method="get" onSubmit="site_search(this)">

	<input name="q" type="hidden" />
	    <label>
	        <span class="screen-reader-text">Search for:</span>
	        <input name="ss_q" type="text" placeholder="Search ..." class="search-field" />
	    </label>
	    <input type="submit" value="Search" class="search-submit" />
	</form>
</aside>

		<aside id="recent-posts-3" class="widget widget_recent_entries">

	
	<h1 class="widget-title">Recent Posts</h1>
		<ul>
			
			<li>
				<a href="http://www.dpetzel.info/post/building-a-dell-t420-with-esxi-5//index.html">Building a Dell T420 with ESXi 5</a>
			</li>
			
		</ul>
	
</aside>

		<aside id="categories-3" class="widget widget_categories">
	
	<h1 class="widget-title">Categories</h1>

	<ul>
		
		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/chef/index.html">Chef</a>
		</li>

		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/hardware/index.html">Hardware</a>
		</li>

		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/programming/index.html">Programming</a>
		</li>

		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/system-administration/index.html">System-Administration</a>
		</li>

		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/tips/jekyll/index.html">Tips/Jekyll</a>
		</li>

		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/tips/python/index.html">Tips/Python</a>
		</li>

		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/tips/windows/index.html">Tips/Windows</a>
		</li>

		
		
		<li class="cat-item">
			<a href="http://www.dpetzel.info//categories/zenoss/index.html">Zenoss</a>
		</li>

		

	</ul>

</aside>

		<span>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<ins class="adsbygoogle"
     style="display:inline-block;width:120px;height:240px"
     data-ad-client="ca-pub-3085354840505663"
     data-ad-slot="7199542960"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</span>


	</div>

</div>

</div>

		</div>

		<footer id="colophon" class="site-footer" role="contentinfo">

			<div class="site-info">
				<a href="http://gohugo.io">Proudly powered by Hugo</a>
			</div>
		</footer>
	</div>

	<script type='text/javascript' src='http://www.dpetzel.info//js/functions.js'></script>
</body>
</html>
